---
title: "Ocean Plastics Pollution"
author: "Rachna Radhakrishna & Sravan Kumar "
format: 
  html:
    theme: cosmo
    toc: true
    toc-depth: 2
    toc-title: "Contents"
editor: visual
---

## Executive Summary

*Sravan edit this please*

This report explores global patterns in plastic pollution based on the 2021 TidyTuesday dataset contributed by Break Free From Plastic. The dataset includes detailed records of plastic items collected during beach cleanups across more than 50 countries, categorized by company (e.g., Coca-Cola, Nestlé), plastic type (e.g., PET, HDPE), and location. Our goal is to identify the top polluting companies globally and analyze variations in plastic waste across regions.

------------------------------------------------------------------------

## Introduction

*Sravan edit this please*

Plastic pollution is a pressing environmental issue, particularly in marine ecosystems where accumulated waste threatens wildlife and water quality. The dataset used in this report provides counts of branded and unbranded plastic items collected during cleanup events between 2019 and 2020. Each observation includes country, brand name (if known), type of plastic material, number of volunteers, and total waste collected. This project aims to explore which companies contribute most to this problem, and how their pollution footprint varies by country.

## Methodology

### Data Cleaning

-   Standardized `parent_company` names:
    -   Fixed capitalization and trimmed whitespace
    -   Grouped unclear labels ("Null", "N/A", "Assorted") as `"Unbranded"`
-   Removed rows labeled `"Grand Total"` (summary rows, not real observations)
-   Tidied `country` names:
    -   Fixed formatting (e.g., `"Cote D Ivoire"` → `"Côte d'Ivoire"`)
-   Ensured all plastic count columns were numeric
-   Replaced missing values with `0` where appropriate

```{r load-libraries, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(janitor)
library(viridis)
library(knitr)
library(ggthemes)
library(forcats)
library(readr)
library(kableExtra)
library(skimr)
```

```{r load-data-raw, echo=FALSE, message=FALSE, warning=FALSE}
# Load and clean data
plastics <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-26/plastics.csv") %>%
  clean_names()
```

```{r clean-data, echo=FALSE, message=FALSE, warning=FALSE}
# Clean data
cleaned_plastics <- plastics %>%
  clean_names() %>%
  mutate(
    # Clean parent_company names
    parent_company = str_trim(str_to_title(parent_company)),
    parent_company = str_replace_all(parent_company, "Coca Cola", "The Coca-Cola Company"),
    parent_company = str_replace_all(parent_company, "Nestlé", "Nestle"),
    parent_company = case_when(
      str_detect(parent_company, "(?i)^(Grand Total)$") ~ NA_character_,
      str_detect(parent_company, "(?i)^(Null|N/?A|Assorted|Unbranded)$") ~ "Unbranded",
      TRUE ~ parent_company
    )
  ) %>%
  # Clean country names
  mutate(
    country = str_trim(str_to_title(country)),
    country = str_replace_all(country, "_", " "),
    country = case_when(
      country == "Empty" ~ NA_character_,
      country == "Cote D Ivoire" ~ "Côte d'Ivoire",
      country == "Cote D ivoire" ~ "Côte d'Ivoire",
      country == "Taiwan Republic Of China (Roc)" ~ "Taiwan",
      country == "Taiwan  Republic Of China (Roc)" ~ "Taiwan",
      country == "Korea" ~ "South Korea",
      country == "United Kingdom Of Great Britain & Northern Ireland" ~ "United Kingdom",
      country == "United States Of America" ~ "United States",
      TRUE ~ country
    )
  ) %>%
  filter(!is.na(parent_company), !is.na(country))
```

------------------------------------------------------------------------

### What’s in the `cleaned_plastics` dataset?

| Column           | Description                                     |
|------------------|-------------------------------------------------|
| `country`        | Country where the cleanup took place            |
| `year`           | Year of data collection (2019 or 2020)          |
| `parent_company` | Brand or company name (e.g., Coca-Cola, Nestle) |
| `empty`          | Count of unidentifiable or label-less plastics  |
| `hdpe`           | Count of HDPE (High-Density Polyethylene) items |
| `ldpe`           | Count of LDPE (Low-Density Polyethylene) items  |
| `o`              | Count of miscellaneous or other plastic types   |
| `pet`            | Count of PET (Polyethylene Terephthalate) items |
| `pp`             | Count of PP (Polypropylene) items               |
| `ps`             | Count of PS (Polystyrene) items                 |
| `pvc`            | Count of PVC (Polyvinyl Chloride) items         |
| `grand_total`    | Total plastic items collected (all types)       |
| `num_events`     | Number of cleanup events                        |
| `volunteers`     | Number of participants involved in cleanups     |

------------------------------------------------------------------------

## Key Findings

### Most Common Plastic Types Collected

```{r simple_bar_plot, echo=FALSE, message=FALSE, warning=FALSE}
# Define the plastic types
plastic_types <- c("hdpe", "ldpe", "o", "pet", "pp", "ps", "pvc")

# Summarise total items by type from cleaned dataset
plastic_counts <- cleaned_plastics %>%
  select(all_of(plastic_types)) %>%
  summarise(across(everything(), sum, na.rm = TRUE)) %>%
  pivot_longer(cols = everything(), names_to = "plastic_type", values_to = "total_items") %>%
  arrange(desc(total_items))

# Plot
ggplot(plastic_counts, aes(x = reorder(plastic_type, total_items), y = total_items, fill = plastic_type)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() +
  scale_fill_viridis_d(option = "E") +  # Use colorblind-friendly palette
  labs(
    title = "Fig.1 - Most Common Plastic Types Collected",
    x = "Plastic Type",
    y = "Total Items Collected"
  ) +
  theme_light(base_size = 10)

```

The above bar chat indicates which type of plastic were most commonly collected during cleanup events around the world and each bar represents a specific type of plastic, and the height of the bar shows the total number of items made from that material. The chat includes well known plastics like:\
**PET** (Polyethylene Terephthalate): Commonly used in plastic drink bottles.

**LDPE** (Low-Density Polyethylene) : Often found in plastic bags and packing films.

**PP** (Polypropylene): Used in bottles caps, food containers and straws.

**HDPE** (High-Density Polyethylene) It is a strong, durable and widely used type of plastic made from petroleum.

**PS** (Polystyrene): Found in disposable cutlery and foam packing.

**PVC** (Polyvinyl Chloride): Less common, but used in pipes and some packing.

*\@ Sravan please condense the above and connect to next analysis*

### Top Contributing Companies to Plastic Waste

```{r top_companies_chunk, echo=FALSE, message=FALSE, warning=FALSE}
library(kableExtra)

top_companies <- cleaned_plastics %>%
  group_by(parent_company) %>%
  summarise(total_plastics = sum(grand_total, na.rm = TRUE)) %>%
  arrange(desc(total_plastics)) %>%
  slice_head(n = 10)

top_companies %>%
  kable(
    caption = "Table 1. Top Companies Contributing to Plastic Waste",
    col.names = c("Company", "Total Plastics"),
    align = "lc",  # left-align company, center-align plastics
    format = "html"  # use "latex" for PDF output
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  row_spec(0, bold = TRUE, background = "#f7f7f7")

```

Table 1 shows the top 10 companies responsible for the most plastic waste, based on the number of plastic items collected. While big companies do play a major role, a significant amount of plastic waste still comes from unknown and difficult to trace sources. Let's dive deeper into the type of plastic waste generated and which country does so in large masses.

```{r country_plastic_relation, echo=FALSE, message=FALSE, warning=FALSE, fig.height=5, fig.width=8}
#Get top 10 countries by total plastic collected
top_countries <- cleaned_plastics %>%
  group_by(country) %>%
  summarise(total_plastic = sum(grand_total, na.rm = TRUE), .groups = "drop") %>%
  arrange(desc(total_plastic)) %>%
  slice_head(n = 10) %>%
  pull(country)

#merged Sravan's input here

#Summarize plastic type totals for those countries
plastic_types_by_country <- cleaned_plastics %>%
  filter(country %in% top_countries) %>%
  group_by(country) %>%
  summarise(across(c(hdpe, ldpe, o, pet, pp, ps, pvc), sum, na.rm = TRUE)) %>%
  pivot_longer(-country, names_to = "plastic_type", values_to = "count")

summary(plastic_types_by_country$count)
#skim(plastic_types_by_country$count)


```

Upon examination of Figure 1 and and cross checking the summary statistics, we can tell that the data is skewed, so applying a log() transformation helps normalize the distribution and improve visual interpretation.

```{r fig-country_plastic_heatmap, echo=FALSE, message=FALSE, warning=FALSE, fig.height=5, fig.width=10}
# Top 10 countries
top_countries <- cleaned_plastics %>%
  group_by(country) %>%
  summarise(total_plastic = sum(grand_total, na.rm = TRUE), .groups = "drop") %>%
  arrange(desc(total_plastic)) %>%
  slice_head(n = 10) %>%
  pull(country)

# Summarise plastic types
plastic_types_by_country <- cleaned_plastics %>%
  filter(country %in% top_countries) %>%
  group_by(country) %>%
  summarise(across(c(hdpe, ldpe, o, pet, pp, ps, pvc), sum, na.rm = TRUE)) %>%
  pivot_longer(-country, names_to = "plastic_type", values_to = "count")

# Heatmap with labels
ggplot(plastic_types_by_country, aes(x = plastic_type, y = fct_reorder(country, -count), fill = count)) +
  geom_tile(color = "white") +
  geom_text(aes(label = ifelse(count > 0, count, "")), size = 3, color = "white") +
  scale_fill_viridis_c(option = "E", trans = "log1p") +
  labs(
    title = "Fig. 2 - Plastic Types Collected by Top 10 Countries",
    x = "Plastic Type",
    y = "Country",
    fill = "Items Collected (log scale)",
    caption = "Source: TidyTuesday 2021-01-26"
  ) +
  theme_fivethirtyeight(base_size = 10)

```

Figure 2 shows the country-wise plastic waste patterns oncovered through collection drives, showing that global brands like Coca-Cola, Nestlé, and PepsiCo are major contributors across multiple countries—e.g., Coca-Cola in the Philippines, Nestlé in Indonesia, and PepsiCo in India and Mexico. These insights underscore the need for targeted corporate accountability and improved waste management strategies.ndefined and type of plastic collected during cleanup events.


```{r volunteer_trend_plot, echo=FALSE, message=FALSE, warning=FALSE}
volunteer_trend_top10 <- cleaned_plastics %>%
  filter(country %in% top_countries) %>%
  group_by(country, year) %>%
  summarise(
    total_volunteers = sum(volunteers, na.rm = TRUE),
    total_plastic = sum(grand_total, na.rm = TRUE),
    .groups = "drop"
  )

ggplot(volunteer_trend_top10, aes(x = reorder(country, -total_volunteers), y = total_volunteers, fill = factor(year))) +
  geom_col(position = position_dodge(width = 0.6), width = 0.4) +  # thinner bars
  scale_fill_manual(
    values = c("2019" = "#00204C", "2020" = "#FDE725"),  # custom colors
    labels = c("2019", "2020")
  ) +
  scale_y_log10(labels = scales::comma_format()) +
  labs(
    title = "Fig. 3 - Volunteer Participation (Top 10 Countries, 2019 vs 2020)",
    x = "Country", y = "Total Volunteers (log scale)",
    fill = "Year"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.x = element_text(angle = 25, hjust = 1),
    legend.position = "top",
    panel.grid.major.x = element_blank()
  )

```



```{r correlation_plot, echo=FALSE, message=FALSE, warning=FALSE, fig.height=5, fig.width=10}
ggplot(volunteer_trend_top10, aes(x = total_volunteers, y = total_plastic, color = country)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "Correlation: Volunteers vs Plastic Collected (Top 10 Countries)",
       x = "Total Volunteers",
       y = "Total Plastic Collected") +
  theme_fivethirtyeight() +
  theme(legend.position = "bottom")

```


```{r}

```

## Discussion

According to Table 1. Interestingly, the majority of the waste—over 400,000 items—was unbranded, hence couldn’t be traced back to a specific company. This highlights a major gap in accountability when it comes to plastic pollution. Among the branded companies, Coca-Cola had the highest count with 23,823 items, followed by La Doo, Nestlé, and Unilever.

Through keen observation in Fig. 2, the 'o (other/unidentified plastics)' category most countries is the most prevalent, indicating either a lack of thorough categorization or more intricate plastic waste. The patterns of collection differ significantly by nation, probably due to variables like regional consumption patterns, waste management strategies, and brand exposure. Plastic reduction policies and corporate accountability initiatives may focus on nations with greater numbers, such as Taiwan, Nigeria, and the Philippines.

## Conclusion

## References
